<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>57.0</apiVersion>
    <assignments>
        <name>Add_Client_Contact_to_List</name>
        <label>Add Client Contact to List</label>
        <locationX>1986</locationX>
        <locationY>971</locationY>
        <assignmentItems>
            <assignToReference>varListOfContactsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>varContactVariable</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Each_contact_Client</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Cooling_Contact_to_List</name>
        <label>Assign Cooling Contact to List</label>
        <locationX>2602</locationX>
        <locationY>1079</locationY>
        <assignmentItems>
            <assignToReference>varListOfContactsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>varContactVariable</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Each_contact_Cooling</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Contact_as_Client</name>
        <label>Set Contact as Client</label>
        <locationX>1986</locationX>
        <locationY>863</locationY>
        <assignmentItems>
            <assignToReference>varContactVariable.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Each_contact_Client.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varContactVariable.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Client</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Client_Contact_to_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Contact_as_Cooling</name>
        <label>Set Contact as Cooling</label>
        <locationX>2602</locationX>
        <locationY>971</locationY>
        <assignmentItems>
            <assignToReference>varContactVariable.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Each_contact_Cooling.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varContactVariable.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Cooling</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Cooling_Contact_to_List</targetReference>
        </connector>
    </assignments>
    <customErrors>
        <name>Error_Close</name>
        <label>Error - Close</label>
        <locationX>50</locationX>
        <locationY>431</locationY>
        <customErrorMessages>
            <errorMessage>You can not modify an Opportunity that is already Closed</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <decisions>
        <name>Account_Status</name>
        <label>Account Status?</label>
        <locationX>534</locationX>
        <locationY>647</locationY>
        <defaultConnector>
            <targetReference>Lead_converted</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Cooling</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Account.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Cooling</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Account_Re_engage_customer</targetReference>
            </connector>
            <label>Cooling</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_Contact_is_not_Client_nor_Cancelled</name>
        <label>Check if Contact is not Client nor Cancelled</label>
        <locationX>2734</locationX>
        <locationY>863</locationY>
        <defaultConnector>
            <targetReference>Each_contact_Cooling</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Contact_is_not_Client_nor_Cancelled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Each_contact_Cooling.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Client</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Each_contact_Cooling.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Cancelled</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Contact_as_Cooling</targetReference>
            </connector>
            <label>Contact is not Client nor Cancelled</label>
        </rules>
    </decisions>
    <decisions>
        <name>Closed_Date_Changed</name>
        <label>Closed Date Changed</label>
        <locationX>1656</locationX>
        <locationY>2279</locationY>
        <defaultConnector>
            <targetReference>Website_Design</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Expedeit</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CloseDate</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CloseDate</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <elementReference>$Record__Prior.CloseDate</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Push_In_1</targetReference>
            </connector>
            <label>Expedeit</label>
        </rules>
        <rules>
            <name>Postpone</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CloseDate</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CloseDate</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <elementReference>$Record__Prior.CloseDate</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Push_Out_1</targetReference>
            </connector>
            <label>Postpone</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check if it is null so it can be updated</description>
        <name>Contact_Selling_Date</name>
        <label>Contact Selling Date?</label>
        <locationX>974</locationX>
        <locationY>647</locationY>
        <defaultConnector>
            <targetReference>Lead_converted</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Selling_Date_Null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Account.Contact__r.Selling_Date__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Contact_Selling_Date</targetReference>
            </connector>
            <label>Selling Date Null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contract_exisits</name>
        <label>Contract exisits?</label>
        <locationX>1414</locationX>
        <locationY>755</locationY>
        <defaultConnector>
            <targetReference>New_Contract</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Contract_already_created</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Contract_Draft.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Contract_to_Opportunity</targetReference>
            </connector>
            <label>Contract already created</label>
        </rules>
    </decisions>
    <decisions>
        <name>Demo_Date</name>
        <label>Demo Date</label>
        <locationX>1656</locationX>
        <locationY>2879</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Demo_Date_is_changed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Demo_Date__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Demo_Date__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <elementReference>$Record__Prior.Demo_Date__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Reschedules</targetReference>
            </connector>
            <label>Demo Date is changed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_a_touch_up_been_scheduled</name>
        <label>Has a touch up been scheduled?</label>
        <locationX>1656</locationX>
        <locationY>1979</locationY>
        <defaultConnector>
            <targetReference>Closed_Date_Changed</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>No</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Has_a_follow_up_touchpoint_been_schedule__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>No</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Follow_Up_Meeting_Tasks</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>No</label>
        </rules>
    </decisions>
    <decisions>
        <name>Lead_converted</name>
        <label>Lead converted?</label>
        <locationX>1656</locationX>
        <locationY>1679</locationY>
        <defaultConnector>
            <targetReference>Has_a_touch_up_been_scheduled</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Converted_from_Lead</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Lead_Converted__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Source_Lead_Generated</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Converted from Lead</label>
        </rules>
    </decisions>
    <decisions>
        <name>Should_system_block_closed_opportunity_changes</name>
        <label>Should system block closed opportunity changes?</label>
        <locationX>853</locationX>
        <locationY>323</locationY>
        <defaultConnector>
            <targetReference>All_contacts</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Blockclosedopportunitychanges</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>fShouldClosedOpportunityBeBlocked</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Close</targetReference>
            </connector>
            <label>Block closed opportunity changes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Stage</name>
        <label>Stage</label>
        <locationX>1656</locationX>
        <locationY>539</locationY>
        <defaultConnector>
            <targetReference>Lead_converted</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Qualifying</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Qualifying</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Account_Status</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Qualifying</label>
        </rules>
        <rules>
            <name>Selling</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Selling</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contact_Selling_Date</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Selling</label>
        </rules>
        <rules>
            <name>Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Contract</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Draft</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Contract</label>
        </rules>
        <rules>
            <name>Closed_Won</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed Won</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Account_Client</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Closed Won</label>
        </rules>
        <rules>
            <name>Closed_Lost</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed Lost</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Name__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New Sales</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Account_Cooling</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Closed Lost</label>
        </rules>
    </decisions>
    <decisions>
        <name>Website_Design</name>
        <label>Website Design</label>
        <locationX>1656</locationX>
        <locationY>2579</locationY>
        <defaultConnector>
            <targetReference>Demo_Date</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Pro</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Website_Design__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Pro</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Pro_Revision_Text</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Pro</label>
        </rules>
        <rules>
            <name>Custom</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Website_Design__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Custom</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Website_Design__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>BeSpoke</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Custom_Revision_Text</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Custom</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>for1Week</name>
        <dataType>Date</dataType>
        <expression>TODAY()+7</expression>
    </formulas>
    <formulas>
        <name>for30BDays</name>
        <dataType>Date</dataType>
        <expression>CASE( 
  MOD({!$Flow.CurrentDate} - DATE( 1900, 1, 7 ), 7 ),
 1, {!$Flow.CurrentDate} + 40,
 2, {!$Flow.CurrentDate} + 40,
 3, {!$Flow.CurrentDate} + 40,
 4, {!$Flow.CurrentDate} + 40,
 5, {!$Flow.CurrentDate} + 40,
 6, {!$Flow.CurrentDate} + 39,
  {!$Flow.CurrentDate} + 39
)</expression>
    </formulas>
    <formulas>
        <name>forContractRenewalDate</name>
        <dataType>Date</dataType>
        <expression>IF( {!$Record.Record_Type_Name__c} = &#39;Closed Won - New Sales&#39; || {!$Record.Record_Type_Name__c} = &#39;New Sales&#39;,
ADDMONTHS({!$Record.Subscription_Start_Date__c}, {!forContractTerm}),
{!$Record.Contract.Contract_Renewal_Date__c})</expression>
    </formulas>
    <formulas>
        <name>forContractTerm</name>
        <dataType>Number</dataType>
        <expression>VALUE(TEXT({!$Record.Contract_Term_Months__c}))</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Get the last day of the month</description>
        <name>forLastDayMonth</name>
        <dataType>Date</dataType>
        <expression>IF(MONTH({!$Flow.CurrentDate})=12,
DATE(YEAR({!$Flow.CurrentDate})+1,1, 1)-1,
DATE(YEAR({!$Flow.CurrentDate}),MONTH({!$Flow.CurrentDate})+1, 1)-1)</expression>
    </formulas>
    <formulas>
        <name>forPaymentTerm</name>
        <dataType>Number</dataType>
        <expression>VALUE(TEXT({!$Record.Subscription_Fee_Payment_Term__c}))</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>forPushIn</name>
        <dataType>Number</dataType>
        <expression>{!$Record.Push_In_Closed_Date__c}+1</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>forPushOut</name>
        <dataType>Number</dataType>
        <expression>{!$Record.Push_Out_Closed_Date__c}+1</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>forRecordType</name>
        <dataType>Boolean</dataType>
        <expression>IF(
{!$Record.Record_Type_Name__c} = &quot;Add Service&quot;, true, false
)</expression>
    </formulas>
    <formulas>
        <name>forReschedules</name>
        <dataType>Number</dataType>
        <expression>{!$Record.Reschedules__c}+1</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>fShouldClosedOpportunityBeBlocked</name>
        <dataType>Boolean</dataType>
        <expression>AND(
    /* Overall Condition to prevent changes to closed opportunities */
    OR(
       ({!$Record__Prior.IsClosed} = true),
       ({!$Record.IsClosed} = true) &amp;&amp; {!$Record__Prior.IsClosed} = true
    ),

/* Bypass for Admin profile */
    $Profile.Name &lt;&gt; &quot;System Administrator&quot;,
    $Profile.Name &lt;&gt; &quot;System Admin2&quot;,
    $Profile.Name &lt;&gt; &quot;Operations Teams&quot;,
   
   /* Exception for Closed Lost less than 30 days can be reopened */ 
   NOT(
   AND(
          ISPICKVAL({!$Record__Prior.StageName}, &quot;Closed Lost&quot;),
          TODAY() -  {!$Record__Prior.Last_Status_Update__c} &lt; 30,
          {!$Record.IsClosed} = false
   )
   ),

/* Exception to allow editing only DesignTemplate__c for Closed Won */
    NOT(
        AND(
            ISPICKVAL({!$Record.StageName}, &quot;Closed Won&quot;),
            ISCHANGED({!$Record.Design_Template__c})
        )
    ) , 
/* Exception to allow the owner to edit Demo_Notes__c */
   NOT(
       AND(
           ISCHANGED({!$Record.Demo_Notes__c})
       )
   )
)</expression>
    </formulas>
    <interviewLabel>LP - Opportunity updated {!$Flow.CurrentDateTime}</interviewLabel>
    <label>LP - Opportunity updated</label>
    <loops>
        <name>Each_contact_Client</name>
        <label>Each contact - Client</label>
        <locationX>1898</locationX>
        <locationY>755</locationY>
        <collectionReference>All_contacts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Contact_as_Client</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Client_Contacts</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Each_contact_Cooling</name>
        <label>Each contact - Cooling</label>
        <locationX>2514</locationX>
        <locationY>755</locationY>
        <collectionReference>All_contacts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_if_Contact_is_not_Client_nor_Cancelled</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Cooling_Contacts</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Each_contact_re_engage</name>
        <label>Each contact re-engage</label>
        <locationX>402</locationX>
        <locationY>863</locationY>
        <collectionReference>All_contacts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Contact_Re_engage_customer</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Lead_converted</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Follow_Up_Meeting_Tasks</name>
        <label>Follow Up Meeting Tasks</label>
        <locationX>1524</locationX>
        <locationY>2087</locationY>
        <connector>
            <targetReference>Closed_Date_Changed</targetReference>
        </connector>
        <inputAssignments>
            <field>ActivityDate</field>
            <value>
                <elementReference>for1Week</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>$User.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <stringValue>Follow Up Meeting Tasks</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WhatId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Task</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>New_Contract</name>
        <label>New Contract</label>
        <locationX>1546</locationX>
        <locationY>863</locationY>
        <connector>
            <targetReference>Add_Contract_to_Opportunity1</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Billing_Frequency__c</field>
            <value>
                <elementReference>$Record.Subscription_Fee_Payment_Term__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContractTerm</field>
            <value>
                <elementReference>forContractTerm</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Contract_Renewal_Date_1__c</field>
            <value>
                <elementReference>forContractRenewalDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Created_with_Add_Service__c</field>
            <value>
                <elementReference>forRecordType</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Marketing_Fee__c</field>
            <value>
                <elementReference>$Record.Monthly_Marketing_Fee__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Subscription_Fee__c</field>
            <value>
                <elementReference>$Record.Monthly_Subscription_Fee__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>$Record.Account.OwnerId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Paid_Media_Service__c</field>
            <value>
                <elementReference>$Record.Paid_Media_Service__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Term__c</field>
            <value>
                <elementReference>forPaymentTerm</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Product_AI_Lead_Nurturing__c</field>
            <value>
                <elementReference>$Record.Product_AI_Lead_Nurturing__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>StartDate</field>
            <value>
                <elementReference>$Record.Subscription_Start_Date__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Tier_Plan__c</field>
            <value>
                <elementReference>$Record.Tier_Plan__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>All_contacts</name>
        <label>All contacts</label>
        <locationX>1656</locationX>
        <locationY>431</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Stage</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get a contract related with the account to check if it already has a contract in Draft</description>
        <name>Contract_Draft</name>
        <label>Contract - Draft</label>
        <locationX>1414</locationX>
        <locationY>647</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Contract_exisits</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contract</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Related with the same account the opportunity is</description>
        <name>Tenant</name>
        <label>Tenant</label>
        <locationX>1898</locationX>
        <locationY>1271</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Contract_Active</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Account__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Tenant__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Account_Client</name>
        <label>Account - Client</label>
        <locationX>1898</locationX>
        <locationY>647</locationY>
        <connector>
            <targetReference>Each_contact_Client</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Client</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>VIP__c</field>
            <value>
                <elementReference>$Record.VIP__c</elementReference>
            </value>
        </inputAssignments>
        <object>Account</object>
    </recordUpdates>
    <recordUpdates>
        <name>Account_Cooling</name>
        <label>Account - Cooling</label>
        <locationX>2514</locationX>
        <locationY>647</locationY>
        <connector>
            <targetReference>Each_contact_Cooling</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Client</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Cooling</stringValue>
            </value>
        </inputAssignments>
        <object>Account</object>
    </recordUpdates>
    <recordUpdates>
        <name>Account_Re_engage_customer</name>
        <label>Account - Re engage customer</label>
        <locationX>402</locationX>
        <locationY>755</locationY>
        <connector>
            <targetReference>Each_contact_re_engage</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Re - Engage Prospect</stringValue>
            </value>
        </inputAssignments>
        <object>Account</object>
    </recordUpdates>
    <recordUpdates>
        <name>Add_Contract_to_Opportunity</name>
        <label>Add Contract to Opportunity</label>
        <locationX>1282</locationX>
        <locationY>863</locationY>
        <connector>
            <targetReference>Lead_converted</targetReference>
        </connector>
        <inputAssignments>
            <field>ContractId</field>
            <value>
                <elementReference>Contract_Draft.Id</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Add_Contract_to_Opportunity1</name>
        <label>Add Contract to Opportunity</label>
        <locationX>1546</locationX>
        <locationY>971</locationY>
        <connector>
            <targetReference>Lead_converted</targetReference>
        </connector>
        <inputAssignments>
            <field>ContractId</field>
            <value>
                <elementReference>New_Contract</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <description>Add 1 to reschedules field</description>
        <name>Add_Reschedules</name>
        <label>Add Reschedules</label>
        <locationX>1524</locationX>
        <locationY>2987</locationY>
        <inputAssignments>
            <field>Reschedules__c</field>
            <value>
                <elementReference>forReschedules</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Contact_Re_engage_customer</name>
        <label>Contact - Re engage customer</label>
        <locationX>490</locationX>
        <locationY>971</locationY>
        <connector>
            <targetReference>Each_contact_re_engage</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Each_contact_re_engage.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Re - Engage Prospect</stringValue>
            </value>
        </inputAssignments>
        <object>Contact</object>
    </recordUpdates>
    <recordUpdates>
        <name>Contract_Active</name>
        <label>Contract - Active</label>
        <locationX>1898</locationX>
        <locationY>1379</locationY>
        <connector>
            <targetReference>Update_Close_Date</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Ad_Spend_Management_Spend__c</field>
            <value>
                <elementReference>$Record.Ad_Management_Fee__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Ad_Spend__c</field>
            <value>
                <elementReference>$Record.Ad_Spend__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Billing_Frequency__c</field>
            <value>
                <elementReference>$Record.Subscription_Fee_Payment_Term__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContractTerm</field>
            <value>
                <elementReference>forContractTerm</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Contract_Renewal_Date_1__c</field>
            <value>
                <elementReference>forContractRenewalDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Created_with_Add_Service__c</field>
            <value>
                <elementReference>forRecordType</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Marketing_Fee__c</field>
            <value>
                <elementReference>$Record.Monthly_Marketing_Fee__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Subscription_Fee__c</field>
            <value>
                <elementReference>$Record.Monthly_Subscription_Fee__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Paid_Media_Service__c</field>
            <value>
                <elementReference>$Record.Paid_Media_Service__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Term__c</field>
            <value>
                <elementReference>forPaymentTerm</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>StartDate</field>
            <value>
                <elementReference>$Record.Subscription_Start_Date__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Activated</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Tenant__c</field>
            <value>
                <elementReference>Tenant.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Tier_Plan__c</field>
            <value>
                <elementReference>$Record.Tier_Plan__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <name>Contract_Cancelled</name>
        <label>Contract - Cancelled</label>
        <locationX>2514</locationX>
        <locationY>1463</locationY>
        <connector>
            <targetReference>Lead_converted</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Tenant__c</field>
            <value>
                <elementReference>Tenant.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <name>Custom_Revision_Text</name>
        <label>Custom Revision Text</label>
        <locationX>1656</locationX>
        <locationY>2687</locationY>
        <connector>
            <targetReference>Demo_Date</targetReference>
        </connector>
        <inputAssignments>
            <field>Revisions_Text__c</field>
            <value>
                <elementReference>varCustomRevisionText</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Pro_Revision_Text</name>
        <label>Pro Revision Text</label>
        <locationX>1392</locationX>
        <locationY>2687</locationY>
        <connector>
            <targetReference>Demo_Date</targetReference>
        </connector>
        <inputAssignments>
            <field>Revisions_Text__c</field>
            <value>
                <elementReference>varProRevisionText</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Push_In_1</name>
        <label>Push In +1</label>
        <locationX>1392</locationX>
        <locationY>2387</locationY>
        <connector>
            <targetReference>Website_Design</targetReference>
        </connector>
        <inputAssignments>
            <field>Push_In_Closed_Date__c</field>
            <value>
                <elementReference>forPushIn</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Push_Out_1</name>
        <label>Push Out +1</label>
        <locationX>1656</locationX>
        <locationY>2387</locationY>
        <connector>
            <targetReference>Website_Design</targetReference>
        </connector>
        <inputAssignments>
            <field>Push_Out_Closed_Date__c</field>
            <value>
                <elementReference>forPushOut</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Source_Lead_Generated</name>
        <label>Source - Lead Generated</label>
        <locationX>1524</locationX>
        <locationY>1787</locationY>
        <connector>
            <targetReference>Has_a_touch_up_been_scheduled</targetReference>
        </connector>
        <inputAssignments>
            <field>CloseDate</field>
            <value>
                <elementReference>forLastDayMonth</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Source__c</field>
            <value>
                <stringValue>Lead Generated</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Client_Contacts</name>
        <label>Update Client Contacts</label>
        <locationX>1898</locationX>
        <locationY>1163</locationY>
        <connector>
            <targetReference>Tenant</targetReference>
        </connector>
        <inputReference>varListOfContactsToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <description>Close date is updated for today</description>
        <name>Update_Close_Date</name>
        <label>Update Close Date</label>
        <locationX>1898</locationX>
        <locationY>1487</locationY>
        <connector>
            <targetReference>Lead_converted</targetReference>
        </connector>
        <inputAssignments>
            <field>CloseDate</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Contact_Selling_Date</name>
        <label>Update Contact - Selling Date</label>
        <locationX>842</locationX>
        <locationY>755</locationY>
        <connector>
            <targetReference>Lead_converted</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Account.Contact__c</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Selling_Date__c</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <object>Contact</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Cooling_Contacts</name>
        <label>Update Cooling Contacts</label>
        <locationX>2514</locationX>
        <locationY>1355</locationY>
        <connector>
            <targetReference>Contract_Cancelled</targetReference>
        </connector>
        <inputReference>varListOfContactsToUpdate</inputReference>
    </recordUpdates>
    <start>
        <locationX>727</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Should_system_block_closed_opportunity_changes</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Partnership Deals</stringValue>
            </value>
        </filters>
        <object>Opportunity</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <textTemplates>
        <name>bodyContract</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Hi Team!
The contract for {!$Record.Name} has been sent please review accordingly. 
https://luxurypresence.lightning.force.com/{!$Record.Id}</text>
    </textTemplates>
    <textTemplates>
        <name>varCustomRevisionText</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Your purchase of the Services and website entitles you to two (2) rounds of website revisions and edits (Revision Rounds). During your website build process, you may request revisions and will be responsible for all edits submitted in each Revision Round. Revisions Rounds can be used to edit text, images, CMS content and design within the limits of the 20 hours of CSS work included in your Custom Website build. This does not include the creation of new functionality, which may incur an additional charge depending on scope. Any requests that exceed the granted hours will incur an additional charge. Unless otherwise agreed upon in writing, no new functionality may be added during Revision Rounds beyond the original scope agreed upon in writing in this Order Form and Agreement. You must request in writing any additional revisions beyond the two (2) Revision Rounds, and, if accepted by Luxury Presence, Luxury Presence will charge $150 per hour for such additional revisions (Additional Revisions). Quotes for additional revision work will be provided subject to Luxury Presences approval. Additional feature requests and revisions may not be approved by Luxury Presence. Customers approval delay or requests for Additional Revisions is not an acceptable reason to delay payment.
As an additional benefit of your website, you may request up to twenty (20) sold properties to be uploaded to your website. Any properties uploaded beyond twenty (20) sold properties will result in a charge of $10 per additional property.</text>
    </textTemplates>
    <textTemplates>
        <name>varProRevisionText</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Your purchase of the Services and website entitles you to one (1) round of website revisions and edits (Revision Rounds). During your website build process, you may request revisions and will be responsible for all edits submitted in each Revision Round. Revision Rounds can be used to edit text, images, properties and design within the limits of your chosen template. For edits that are outside the scope of your chosen template, two (2) hours of CSS/HTML adjustments can be granted on a solely aesthetic basis. Any requests that exceed the granted hours will incur an additional charge. Unless otherwise agreed upon in writing, no new functionality may be added during Revision Rounds beyond the original scope agreed upon in writing in this Order Form and Agreement. You must request in writing any additional revisions beyond the one (1) Revision Round, and, if accepted by Luxury Presence, Luxury Presence will charge $200 per hour for such additional revisions (Additional Revisions). Quotes for additional revision work will be provided subject to Luxury Presences approval. Additional feature requests and revisions may not be approved by Luxury Presence. Customers approval delay or requests for Additional Revisions is not an acceptable reason to delay payment.
As an additional benefit of your website, you may request up to twenty (20) sold properties to be uploaded to your website. Any properties uploaded beyond twenty (20) sold properties will result in a charge of $10 per additional property.</text>
    </textTemplates>
    <variables>
        <name>varContactVariable</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>varListOfContactsToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
</Flow>
