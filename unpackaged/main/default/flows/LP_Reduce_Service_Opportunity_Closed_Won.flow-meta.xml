<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Effective_Date_Email</name>
        <label>Effective Date Email</label>
        <locationX>578</locationX>
        <locationY>276</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>Book_Reduce_Service_in_Quickbook_User</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <stringValue>billing@luxurypresence.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>forSubject</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>emailBilling</elementReference>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
        <offset>0</offset>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>58.0</apiVersion>
    <assignments>
        <name>Add_Opp_MLS</name>
        <label>Add Opp MLS</label>
        <locationX>3130</locationX>
        <locationY>1116</locationY>
        <assignmentItems>
            <assignToReference>varMLSBoards</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Each_opp_mls.MLS_Board__r.Name</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Each_opp_mls</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Product_NameNotRemovePlan</name>
        <label>Add Product Name</label>
        <locationX>3130</locationX>
        <locationY>708</locationY>
        <assignmentItems>
            <assignToReference>varOppProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Each_opp_product_NotRemovePlan.Product_Name__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Each_opp_product_NotRemovePlan</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Service_Status_Cancelled_IDX</name>
        <label>Service Status - Cancelled - IDX</label>
        <locationX>3306</locationX>
        <locationY>1740</locationY>
        <assignmentItems>
            <assignToReference>varSingleService.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varSingleService.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Each_Service_NotRemovePlan.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varSingleService.MLS_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varServiceCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>varSingleService</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Each_Service_NotRemovePlan</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Service_Status_Cancelled_NotRemovePlan</name>
        <label>Service Status - Cancelled</label>
        <locationX>3570</locationX>
        <locationY>1740</locationY>
        <assignmentItems>
            <assignToReference>varSingleService.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varSingleService.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Each_Service_NotRemovePlan.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varServiceCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>varSingleService</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Each_Service_NotRemovePlan</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Service_Status_Cancelled_RemovePlan</name>
        <label>Service Status - Cancelled</label>
        <locationX>1282</locationX>
        <locationY>708</locationY>
        <assignmentItems>
            <assignToReference>varSingleService.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varSingleService.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Each_Service_RemovePlan.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varServiceCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>varSingleService</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Each_Service_RemovePlan</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assignation of the varSTask in order to create the &quot;Book Reduce Service in Quickbooks&quot;</description>
        <name>Task_Book_Reduce_Service_in_Quickbooks</name>
        <label>Task - Book Reduce Service in Quickbooks</label>
        <locationX>578</locationX>
        <locationY>492</locationY>
        <assignmentItems>
            <assignToReference>varSTask.Subject</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>{!$Record.Name} - Book Reduce Service in Quickbooks</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varSTask.ActivityDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>for1BDay</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varSTask.WhatId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varSTask.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Label.ID_Task_General_Task</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varSTask.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Book_Reduce_Service_in_Quickbook_User.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varSTask.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>txtDescription</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varCTask</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>varSTask</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Task_Book_Reduce_Service</targetReference>
        </connector>
    </assignments>
    <customErrors>
        <name>Error_Budget_0</name>
        <label>Error Budget 0</label>
        <locationX>314</locationX>
        <locationY>2688</locationY>
        <customErrorMessages>
            <errorMessage>Please Cancel the Lead Gen Service</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <decisions>
        <name>Ad_Spend_Product</name>
        <label>Ad Spend Product</label>
        <locationX>314</locationX>
        <locationY>2580</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Ad_Spend_True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Ad_Spend_Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>forAdBudget</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Lead_Gen_Ads</targetReference>
            </connector>
            <label>Ad Spend - True</label>
        </rules>
        <rules>
            <name>Ad_Budget_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>forAdBudget</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Lead_Gen_Service__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Budget_0</targetReference>
            </connector>
            <label>Ad Budget = 0</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contract_referenced</name>
        <label>Contract referenced?</label>
        <locationX>578</locationX>
        <locationY>708</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Contract_found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.ContractId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract</targetReference>
            </connector>
            <label>Contract found</label>
        </rules>
    </decisions>
    <decisions>
        <name>Product</name>
        <label>Product?</label>
        <locationX>3570</locationX>
        <locationY>1632</locationY>
        <defaultConnector>
            <targetReference>Each_Service_NotRemovePlan</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Presence_Copilot_or_White_Label_App</name>
            <conditionLogic>(1 OR 2) AND 3</conditionLogic>
            <conditions>
                <leftValueReference>Each_Service_NotRemovePlan.Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Copilot Agent Seat</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Each_Service_NotRemovePlan.Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>White Label App</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Contract.Count_of_Copilot_Agent_Seats__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Each_Service_NotRemovePlan</targetReference>
            </connector>
            <label>Presence Copilot or White Label App</label>
        </rules>
        <rules>
            <name>IDX</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Each_Service_NotRemovePlan.Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>IDX Tool</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varMLSBoards</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Each_Service_NotRemovePlan.MLS_Board__r.Name</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Service_Status_Cancelled_IDX</targetReference>
            </connector>
            <label>IDX</label>
        </rules>
        <rules>
            <name>No_IDX</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Each_Service_NotRemovePlan.Product__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>IDX Tool</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Service_Status_Cancelled_NotRemovePlan</targetReference>
            </connector>
            <label>No IDX</label>
        </rules>
        <rules>
            <name>Automated_Blogs</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Each_Service_NotRemovePlan.Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Automated Blogs</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Contract.Count_of_Monthly_Blogs__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Each_Service_NotRemovePlan</targetReference>
            </connector>
            <label>Automated Blogs</label>
        </rules>
    </decisions>
    <decisions>
        <name>Product_Match_NotRemovePlan</name>
        <label>Product Match?</label>
        <locationX>3878</locationX>
        <locationY>1524</locationY>
        <defaultConnector>
            <targetReference>Each_Service_NotRemovePlan</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Match_NotRemovePlan</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varOppProducts</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Each_Service_NotRemovePlan.Product__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Product</targetReference>
            </connector>
            <label>Match</label>
        </rules>
    </decisions>
    <decisions>
        <name>Remove_Plan</name>
        <label>Remove Plan?</label>
        <locationX>2118</locationX>
        <locationY>276</locationY>
        <defaultConnector>
            <targetReference>Copy_1_of_Contract_Fees</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Remove_Plan__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Fees</targetReference>
            </connector>
            <label>True</label>
        </rules>
    </decisions>
    <decisions>
        <name>Remove_Plan_Automated_Blogs</name>
        <label>Remove Plan?</label>
        <locationX>314</locationX>
        <locationY>1872</locationY>
        <defaultConnector>
            <targetReference>White_Label_App_Product</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Remove_Plan_False_Automated_Blogs</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Remove_Plan__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Automated_Blogs_Product.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Count_Monthly_Blogs</targetReference>
            </connector>
            <label>Remove Plan - False - Automated Blogs</label>
        </rules>
    </decisions>
    <decisions>
        <name>Remove_Plan_today</name>
        <label>Remove Plan?</label>
        <locationX>314</locationX>
        <locationY>1032</locationY>
        <defaultConnector>
            <targetReference>Automated_Blogs_Product</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Remove_Plan_False_Copilot</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Remove_Plan__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Copilot_Agent_Seats_Product.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Fees_Count_Agent</targetReference>
            </connector>
            <label>Remove Plan - False - Copilot</label>
        </rules>
    </decisions>
    <decisions>
        <name>Remove_Plan_White_Label_App</name>
        <label>Remove Plan?</label>
        <locationX>314</locationX>
        <locationY>2280</locationY>
        <defaultConnector>
            <targetReference>Ad_Spend_Product</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Remove_Plan_False_White_Label_App</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Remove_Plan__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>White_Label_App_Product.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Contract_Count_of_Agent_Seats</targetReference>
            </connector>
            <label>Remove Plan - False - White Label App</label>
        </rules>
    </decisions>
    <description>Removing the &quot;Billing Start Date&quot; field reference and implementing the Addendum Effective Date enhancement.</description>
    <environments>Default</environments>
    <formulas>
        <description>Add 1 business day</description>
        <name>for1BDay</name>
        <dataType>Date</dataType>
        <expression>CASE(
  MOD({!$Flow.CurrentDate} - DATE( 1900, 1, 7 ), 7 ),
  5, {!$Flow.CurrentDate} + 3,
  6, {!$Flow.CurrentDate} + 2,
  {!$Flow.CurrentDate} + 1
)</expression>
    </formulas>
    <formulas>
        <name>forAdBudget</name>
        <dataType>Currency</dataType>
        <expression>{!$Record.Lead_Gen_Service__r.Monthly_Budget__c} - {!$Record.Ad_Spend__c}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>forAdSpend</name>
        <dataType>Currency</dataType>
        <expression>{!$Record.Contract.Ad_Spend__c} - {!$Record.Ad_Spend__c}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Subtract the Ad Spend Management of the Contract and the Opportunity field</description>
        <name>forAdSpendManagement</name>
        <dataType>Currency</dataType>
        <expression>{!$Record.Contract.Ad_Spend_Management_Spend__c} - {!$Record.Ad_Management_Fee__c}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>forCountMonthlyBlogs</name>
        <dataType>Number</dataType>
        <expression>{!$Record.Contract.Count_of_Monthly_Blogs__c} - {!Automated_Blogs_Product.Quantity}</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>forCountOfAgentSeats</name>
        <dataType>Number</dataType>
        <expression>{!$Record.Contract.Count_of_Copilot_Agent_Seats__c} - {!Copilot_Agent_Seats_Product.Quantity}</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>forCountOfWhiteLabelApp</name>
        <dataType>Number</dataType>
        <expression>{!$Record.Contract.Count_of_Copilot_Agent_Seats__c} - {!White_Label_App_Product.Quantity}</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>forMonthlyMarketingFee</name>
        <dataType>Currency</dataType>
        <expression>{!$Record.Contract.Monthly_Marketing_Fee__c}- {!$Record.Monthly_Marketing_Fee__c}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>forMonthlySubscriptionFee</name>
        <dataType>Currency</dataType>
        <expression>{!$Record.Contract.Monthly_Subscription_Fee__c} - {!$Record.Monthly_Subscription_Fee__c}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>forSubject</name>
        <dataType>String</dataType>
        <expression>{!$Record.Account.Name} +&quot; - &quot; + {!$Record.Record_Type_Name__c}+ &quot; - &quot;+ TEXT({!$Record.Billing_Start_Date__c})</expression>
    </formulas>
    <interviewLabel>LP - Reduce Service - Opportu {!$Flow.CurrentDateTime}</interviewLabel>
    <label>LP - Reduce Service - Opportunity - Closed Won</label>
    <loops>
        <name>Each_opp_mls</name>
        <label>Each opp mls</label>
        <locationX>3042</locationX>
        <locationY>1008</locationY>
        <collectionReference>Opportunity_MLS</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Opp_MLS</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Services_NotRemovePlan</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Each_opp_product_NotRemovePlan</name>
        <label>Each opp product</label>
        <locationX>3042</locationX>
        <locationY>600</locationY>
        <collectionReference>Opportunity_Products_NotRemovePlan</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Product_NameNotRemovePlan</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Opportunity_MLS</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Each_Service_NotRemovePlan</name>
        <label>Each Service</label>
        <locationX>3042</locationX>
        <locationY>1416</locationY>
        <collectionReference>Services_NotRemovePlan</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Product_Match_NotRemovePlan</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Services</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Each_Service_RemovePlan</name>
        <label>Each Service</label>
        <locationX>1194</locationX>
        <locationY>600</locationY>
        <collectionReference>Services_RemovePlan</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Service_Status_Cancelled_RemovePlan</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Services_RemovePlan</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <description>Create all task added to the Task collection</description>
        <name>Create_Task_Book_Reduce_Service</name>
        <label>Create Task - Book Reduce Service</label>
        <locationX>578</locationX>
        <locationY>600</locationY>
        <connector>
            <targetReference>Contract_referenced</targetReference>
        </connector>
        <inputReference>varCTask</inputReference>
    </recordCreates>
    <recordCreates>
        <description>Create &quot;Reduce Copilot Agent User Seat&quot; task</description>
        <name>Reduce_Copilot_Task</name>
        <label>Reduce Copilot - Task</label>
        <locationX>182</locationX>
        <locationY>1572</locationY>
        <connector>
            <targetReference>Automated_Blogs_Product</targetReference>
        </connector>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>User_Copilot_User.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>Record_Type_General_Task.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <stringValue>{!$Record.Account.Name} - Reduce Copilot Agent User Seat</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WhatId</field>
            <value>
                <elementReference>Copilot_Service.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Task</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <description>Review if the opportunity has Automated Blogs Product</description>
        <name>Automated_Blogs_Product</name>
        <label>Automated Blogs Product</label>
        <locationX>314</locationX>
        <locationY>1764</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Remove_Plan_Automated_Blogs</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Product_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Automated Blogs</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get user, in order to assigned the Book Reduce Service tasks</description>
        <name>Book_Reduce_Service_in_Quickbook_User</name>
        <label>Book Reduce Service in Quickbook - User</label>
        <locationX>578</locationX>
        <locationY>384</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Task_Book_Reduce_Service_in_Quickbooks</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Book_New_Sale_in_Quickbooks__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Contract</name>
        <label>Contract</label>
        <locationX>314</locationX>
        <locationY>816</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Copilot_Agent_Seats_Product</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contract</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Review if the opportunity has copilot agent seats product</description>
        <name>Copilot_Agent_Seats_Product</name>
        <label>Copilot Agent Seats Product</label>
        <locationX>314</locationX>
        <locationY>924</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Remove_Plan_today</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Product_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Copilot Agent Seat</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Copilot_Service</name>
        <label>Copilot - Service</label>
        <locationX>182</locationX>
        <locationY>1464</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Reduce_Copilot_Task</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Presence Copilot</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Service__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Opportunity_MLS</name>
        <label>Opportunity MLS</label>
        <locationX>3042</locationX>
        <locationY>900</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Each_opp_mls</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Opportunity__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Opportunity_MLS_Board__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Opportunity_Products_NotRemovePlan</name>
        <label>Opportunity Products</label>
        <locationX>3042</locationX>
        <locationY>492</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Each_opp_product_NotRemovePlan</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Record_Type_General_Task</name>
        <label>Record Type - General Task</label>
        <locationX>182</locationX>
        <locationY>1356</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Copilot_Service</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Task</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>General_Task</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Services_NotRemovePlan</name>
        <label>Services</label>
        <locationX>3042</locationX>
        <locationY>1308</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Each_Service_NotRemovePlan</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Service__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Services_RemovePlan</name>
        <label>Services</label>
        <locationX>1194</locationX>
        <locationY>492</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Each_Service_RemovePlan</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Service__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>User_Copilot_User</name>
        <label>User - Copilot User</label>
        <locationX>182</locationX>
        <locationY>1248</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Record_Type_General_Task</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Copilot__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>IsActive</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Review if the opportunity has White Label App Product</description>
        <name>White_Label_App_Product</name>
        <label>White Label App Product</label>
        <locationX>314</locationX>
        <locationY>2172</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Remove_Plan_White_Label_App</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Product_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Copilot (White-Label) Agent Seat</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <description>Update quantity of Monthly Blogs</description>
        <name>Contract_Count_Monthly_Blogs</name>
        <label>Contract - Count Monthly Blogs</label>
        <locationX>182</locationX>
        <locationY>1980</locationY>
        <connector>
            <targetReference>White_Label_App_Product</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Count_of_Monthly_Blogs__c</field>
            <value>
                <elementReference>forCountMonthlyBlogs</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <description>Update subscriptions fee</description>
        <name>Contract_Fees</name>
        <label>Contract - Fees</label>
        <locationX>1194</locationX>
        <locationY>384</locationY>
        <connector>
            <targetReference>Services_RemovePlan</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Ad_Spend_Management_Spend__c</field>
            <value>
                <elementReference>forAdSpendManagement</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Ad_Spend__c</field>
            <value>
                <elementReference>forAdSpend</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Marketing_Fee__c</field>
            <value>
                <elementReference>forMonthlyMarketingFee</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Subscription_Fee__c</field>
            <value>
                <elementReference>forMonthlySubscriptionFee</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <description>Update status, fees and quantity of Count of Agent Seats</description>
        <name>Contract_Fees_Count_Agent</name>
        <label>Contract - Fees - Count Agent</label>
        <locationX>182</locationX>
        <locationY>1140</locationY>
        <connector>
            <targetReference>User_Copilot_User</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Ad_Spend_Management_Spend__c</field>
            <value>
                <elementReference>forAdSpendManagement</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Ad_Spend__c</field>
            <value>
                <elementReference>forAdSpend</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Count_of_Copilot_Agent_Seats__c</field>
            <value>
                <elementReference>forCountOfAgentSeats</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Marketing_Fee__c</field>
            <value>
                <elementReference>forMonthlyMarketingFee</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Subscription_Fee__c</field>
            <value>
                <elementReference>forMonthlySubscriptionFee</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <description>Update subscriptions fee</description>
        <name>Copy_1_of_Contract_Fees</name>
        <label>Contract - Fees</label>
        <locationX>3042</locationX>
        <locationY>384</locationY>
        <connector>
            <targetReference>Opportunity_Products_NotRemovePlan</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Ad_Spend_Management_Spend__c</field>
            <value>
                <elementReference>forAdSpendManagement</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Ad_Spend__c</field>
            <value>
                <elementReference>forAdSpend</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Marketing_Fee__c</field>
            <value>
                <elementReference>forMonthlyMarketingFee</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Monthly_Subscription_Fee__c</field>
            <value>
                <elementReference>forMonthlySubscriptionFee</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <description>Update quantity of Agent Seats</description>
        <name>Update_Contract_Count_of_Agent_Seats</name>
        <label>Update Contract Count of Agent Seats</label>
        <locationX>182</locationX>
        <locationY>2388</locationY>
        <connector>
            <targetReference>Ad_Spend_Product</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContractId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Count_of_Copilot_Agent_Seats__c</field>
            <value>
                <elementReference>forCountOfWhiteLabelApp</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Lead_Gen_Ads</name>
        <label>Update Lead Gen Ads</label>
        <locationX>50</locationX>
        <locationY>2688</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Lead_Gen_Service__c</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Monthly_Budget__c</field>
            <value>
                <elementReference>forAdBudget</elementReference>
            </value>
        </inputAssignments>
        <object>Service__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Services</name>
        <label>Update - Services</label>
        <locationX>3042</locationX>
        <locationY>2100</locationY>
        <inputReference>varServiceCollection</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Services_RemovePlan</name>
        <label>Update Services</label>
        <locationX>1194</locationX>
        <locationY>900</locationY>
        <inputReference>varServiceCollection</inputReference>
    </recordUpdates>
    <start>
        <locationX>1222</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Effective_Date_Email</targetReference>
        </connector>
        <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
        <filterLogic>and</filterLogic>
        <filters>
            <field>StageName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Closed Won</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Reduce Service</stringValue>
            </value>
        </filters>
        <object>Opportunity</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <scheduledPaths>
            <name>Addendum_Effective_Date</name>
            <connector>
                <targetReference>Remove_Plan</targetReference>
            </connector>
            <label>Addendum Effective Date</label>
            <offsetNumber>1</offsetNumber>
            <offsetUnit>Minutes</offsetUnit>
            <recordField>Addendum_Execution_Date__c</recordField>
            <timeSource>RecordField</timeSource>
        </scheduledPaths>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <textTemplates>
        <name>emailBilling</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Hi team!
The client {!$Record.Account.Name} has closed won the addendum {!$Record.Name} , with effective date {!$Record.Addendum_Execution_Date__c}.
Link to the opportunity: https://luxurypresence.lightning.force.com/{!$Record.Id}</text>
    </textTemplates>
    <textTemplates>
        <description>Used in the creation of the tasks</description>
        <name>txtDescription</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Opportunity link: https://luxurypresence.lightning.force.com/{!$Record.Id}</text>
    </textTemplates>
    <triggerOrder>1200</triggerOrder>
    <variables>
        <description>Collection of task</description>
        <name>varCTask</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
    <variables>
        <name>varMLSBoards</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varOppProducts</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varServiceCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Service__c</objectType>
    </variables>
    <variables>
        <name>varSingleService</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Service__c</objectType>
    </variables>
    <variables>
        <name>varSTask</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
</Flow>
